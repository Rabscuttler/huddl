<%= partial :group_header %>

<% if @membership.admin? %>
  <% form_tag "/timetables/create?group_id=#{@group.id}", :class => 'form-inline' do %>
    <%= text_field_tag :name, :class => 'form-control', :style => 'width: 10em', :placeholder => 'New timetable' %>
    <%= submit_tag :class => 'btn btn-primary' %>
  <% end %>
<% end %>

<h2>
  <% if @membership.admin? %>
    <a data-confirm="Delete this timetable?" href="/timetables/<%=@timetable.id%>/destroy">
      <%=@timetable.name%>
    </a>
  <% else %>
    <%=@timetable.name%>
  <% end %>     
</h2>

<a class="btn btn-primary" href="javascript:;" onclick="$(this).hide().next().show()"><i class="fa fa-plus-circle"></i> Propose an activity</a>
<div style="display: none" class="activity-form">
  <%= partial :'timetables/activity_form', :locals => {:timetable => @timetable}%>  
</div>

<div data-pagelet-url="/h/<%=@group.slug%>/timetables/<%=@timetable.id%>">
  <%= partial :'timetables/timetable', :locals => {:timetable => @timetable} %>
</div>


<% if @membership.admin? %>

  <a class="btn btn-primary" href="javascript:;" onclick="$(this).hide().next().show()"><i class="fa fa-exchange"></i> Reorder</a>
  <div style="display: none" class="activity-form">

    <h3>Reorder spaces</h3>
    <ul class="spaces" data-timetable-id="<%=@timetable.id%>">
      <% @timetable.spaces.order('o asc').each { |space| %>
        <li id="<%=space.id%>"><%= space.name %></li>
      <% } %>
    </ul>
    <p style="display: none">
      <em>Refresh the page to see your changes</em>
    </p>              

    <h3>Reorder slots</h3>
    <ul class="tslots" data-timetable-id="<%=@timetable.id%>">
      <% @timetable.tslots.order('o asc').each { |tslot| %>
        <li id="<%=tslot.id%>"><%= tslot.name %></li>
      <% } %>
    </ul>  
    <p style="display: none">
      <em>Refresh the page to see your changes</em>
    </p>              

  </div>        

<% end %>